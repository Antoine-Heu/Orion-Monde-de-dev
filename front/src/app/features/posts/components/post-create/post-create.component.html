<div class="create-post-container">
  <div class="title-section">
    <div class="back-btn" (click)="goBack()">
      <mat-icon>keyboard_backspace</mat-icon>
    </div>
    <div class="post-content-wrapper">
      <h1 class="post-title">Créer un nouvel article</h1>
    </div>
  </div>

  <div class="create-post-content">

    <form [formGroup]="postForm" (ngSubmit)="onSubmit()" class="post-form">
      <div class="form-group">
        <label class="form-label">Titre</label>
        <input
          class="form-input"
          formControlName="title"
          type="text"
          placeholder="Entrez le titre de l'article">
        <div class="error-message" *ngIf="postForm.get('title')?.hasError('required') && postForm.get('title')?.touched">
          Le titre est requis
        </div>
        <div class="error-message" *ngIf="postForm.get('title')?.hasError('minlength') && postForm.get('title')?.touched">
          Le titre doit contenir au moins 3 caractères
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">Thème</label>
        <select class="form-input" formControlName="topicId">
          <option value="">Sélectionnez un thème</option>
          <option *ngFor="let topic of topics$ | async" [value]="topic.id">
            {{ topic.title }}
          </option>
        </select>
        <div class="error-message" *ngIf="postForm.get('topicId')?.hasError('required') && postForm.get('topicId')?.touched">
          Le thème est requis
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">Contenu</label>
        <textarea
          class="form-textarea"
          formControlName="content"
          rows="8"
          placeholder="Entrez le contenu de l'article"></textarea>
        <div class="error-message" *ngIf="postForm.get('content')?.hasError('required') && postForm.get('content')?.touched">
          Le contenu est requis
        </div>
        <div class="error-message" *ngIf="postForm.get('content')?.hasError('minlength') && postForm.get('content')?.touched">
          Le contenu doit contenir au moins 10 caractères
        </div>
      </div>

      <div class="error-message" *ngIf="errorMessage">
        {{ errorMessage }}
      </div>

      <div class="form-actions">
        <button
          type="submit"
          [disabled]="postForm.invalid || isLoading"
          class="submit-btn">
          {{ isLoading ? 'Création...' : 'Créer' }}
        </button>
      </div>
    </form>
  </div>
</div>
